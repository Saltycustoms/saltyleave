<html>
  <head>
  </head>

  <body>
    <header>
      <div class="top-bar">
        <div class="top-bar-left">
          <ul class="menu">
            <li class="menu-text">Saltyleave</li>
            <li class="menu-text">Current User: <%= current_user.name %></li>
          </ul>
        </div>

        <div class="top-bar-right">
          <ul class="menu">
            <li><a href="/leave_applications">View Leave Applications</a></li>
            <li class="menu-text">Apply for Leave</li>
            <% if current_user.is_head? || current_user.is_director? %>
              <li><a href="/approvals">Approve Leave Applications</a></li>
              <li><a href="/users">View Users</a></li>
            <% end %>
            <li><a href="/users/sign_out" data-method="delete" class="alert button">Log Out</a></li>
          </ul>
        </div>
      </div>
    </header>
    <br>
    <div class="row">
      <div class="large-7 columns">
        <h4>Calendar</h4>
        <%= month_calendar events: @leaves do |date, leave_applications| %>
          <%= date.mday %>

          <% if !date.saturday? && !date.sunday? %>
            <% leave_applications.each do |leave_application| %>
              <div>
                <%= leave_application.user.name %>
              </div>
            <% end %>
          <% end %>
        <% end %>
      </div>

      <div class="large-4 large-offset-1 columns">
        <% if @leave_application.errors.any? %>
          <div class="callout alert" id="error_explanation">
            <h4>
              <%= pluralize(@leave_application.errors.count, "error") %> prohibited this application from being saved:
            </h4>
            <ul>
              <% @leave_application.errors.full_messages.each do |msg| %>
                <li><%= msg %></li>
              <% end %>
            </ul>
          </div>
        <% end %>

        <h6>
          <strong><%= "#{pluralize(current_user.annual_days, 'day')}" %></strong>
          <%= " of annual leave available" %>
        </h6>
        <h6>
          <strong><%= "#{pluralize(current_user.sick_days, 'day')}" %></strong>
          <%= " of sick leave available" %>
        </h6>
        <h6>
          <strong><%= "#{pluralize(current_user.unpaid_days, 'day')}" %></strong>
          <%= " of unpaid leave available" %>
        </h6>

        <%= simple_form_for :leave_application, url: leave_applications_path do |f| %>
          <%= f.input :leave_type, collection: LeaveApplication.leave_types.keys, include_blank: false %>
          <%= f.input :start_date, as: :date %>
          <%= f.input :end_date, as: :date %>
          <%= f.input :leave_duration, collection: LeaveApplication.leave_durations.keys, include_blank: false %>
          <%= f.input :reason, as: :text, placeholder: 'Just a brief description' %>
          <%= f.input :attachment, as: :file, required: false %>
          <%= f.button :submit %>
        <% end %>
      </div>
    </div>
  </body>
</html>
